<header class="hero">
  <div class="container hero-inner">
    <nav class="topbar">
      <div class="brand">
        <span class="brand-mark" aria-hidden="true">‚óè</span>
        <span class="brand-name">RECIPE<span class="accent">BERRY</span></span>
      </div>

      <div class="actions">
        <a class="btn btn-outline" routerLink="/add">+ Add Recipe</a>
      </div>
    </nav>

    <div class="controls">
      <div class="search shadow-soft round-12">
        <span class="search-icon" aria-hidden="true">üîé</span>

        <!-- ‚úî ngModelChange (·Éô·Éê·É°·É¢·Éò·Éú·Éí·Éò·É° ·Éí·Éê·É†·Éî·É®·Éî) -->
        <input
          type="text"
          [ngModel]="query()"
          (ngModelChange)="debouncedRefresh($event)"
          placeholder="Search by title or ingredient‚Ä¶"
          aria-label="Search recipes"
        />

        <button
          class="clear"
          *ngIf="query()"
          (click)="clearSearch()"
          aria-label="Clear search"
          title="Clear"
        >
          ‚úï
        </button>
      </div>

      <label class="chip">
        <input
          type="checkbox"
          [ngModel]="onlyFavorites()"
          (ngModelChange)="onlyFavorites.set($event); refresh()"
        />
        <span>Favorites only</span>
      </label>
    </div>
  </div>
</header>

<main class="container">
  <!-- Skeleton while loading -->
  <section class="grid" *ngIf="loading(); else content">
    <div class="card skeleton" *ngFor="let _ of [1,2,3,4,5,6]"></div>
  </section>

  <ng-template #content>
    <section class="grid" *ngIf="filtered().length; else emptyState">
      <article class="card shadow-soft" *ngFor="let r of filtered(); trackBy: trackById">
        <div class="thumb-wrap">
          <img class="thumb" [src]="r.thumbnail || placeholder" [alt]="r.title" />
          <div class="badge" [class.gray]="!r.isFavorite">
            {{ r.isFavorite ? 'favorite' : 'recipe' }}
          </div>
        </div>

        <div class="content">
          <h3>{{ r.title }}</h3>
          <p class="desc">{{ r.description }}</p>
        </div>

        <div class="footer">
          <button class="btn btn-ghost" (click)="toggleFavorite(r)" [attr.aria-pressed]="r.isFavorite">
            <span class="star" [class.active]="r.isFavorite">‚òÖ</span>
            <span>{{ r.isFavorite ? 'Unfavorite' : 'Favorite' }}</span>
          </button>

          <a class="btn btn-primary" [routerLink]="['/recipes', r.id]">View</a>
        </div>
      </article>
    </section>

    <ng-template #emptyState>
      <div class="empty">
        <div class="emoji" aria-hidden="true">ü•£</div>
        <h2>No recipes yet</h2>
        <p>Try adjusting your search or add a new recipe.</p>
        <a class="btn btn-primary" routerLink="/add">Add Recipe</a>
      </div>
    </ng-template>
  </ng-template>
</main>
