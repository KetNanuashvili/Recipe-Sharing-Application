<header class="hero">
  <div class="container hero-inner">
    <nav class="topbar shadow-soft">
      <div class="brand" routerLink="/" aria-label="RecipeBerry Home">
        <span class="brand-mark" aria-hidden="true">‚óè</span>
        <span class="brand-name">RE<span class="accent">CIPE</span></span>
      </div>
      <div class="actions">
        <a class="btn btn-outline" routerLink="/">‚Üê Back</a>
      </div>
    </nav>
  </div>
</header>

<main class="container">
  <section class="form-card shadow-soft">
    <h1 class="title">Edit Recipe</h1>
    <p class="subtitle">Update the fields below and save your changes.</p>

    <form [formGroup]="form" (ngSubmit)="save()" novalidate>
      <div class="grid-2">
        <!-- LEFT -->
        <div class="stack">
          <label class="field">
            <span>Title *</span>
            <input type="text" formControlName="title" placeholder="e.g. Chicken Salad" />
            <small class="err" *ngIf="fieldInvalid('title')">Please enter a title (min 3 chars).</small>
          </label>

          <label class="field">
            <span>Description *</span>
            <textarea formControlName="description" rows="3" placeholder="Short summary..."></textarea>
            <small class="err" *ngIf="fieldInvalid('description')">Please enter a description (min 10 chars).</small>
          </label>

          <div class="field">
            <span>Ingredients *</span>
            <div class="chips">
              <input type="text" placeholder="Type and press Enter"
                     (keydown.enter)="$event.preventDefault(); addFromInput($event, 'ingredients')"
                     (blur)="addFromInput($event, 'ingredients')" />
              <div class="chip" *ngFor="let ing of ingredientsArr.controls; index as i">
                <span>{{ ing.value }}</span>
                <button type="button" class="x" (click)="removeChip('ingredients', i)" aria-label="Remove">‚úï</button>
              </div>
            </div>
            <small class="err" *ngIf="ingredientsArr.invalid && ingredientsArr.touched">
              Please add at least one ingredient.
            </small>
          </div>

          <label class="field">
            <span>Instructions *</span>
            <textarea formControlName="instructions" rows="6" placeholder="Step 1..., Step 2..., etc."></textarea>
            <small class="err" *ngIf="fieldInvalid('instructions')">Please provide instructions (min 15 chars).</small>
          </label>

          <div class="grid-3">
            <label class="field">
              <span>Time (min)</span>
              <input type="number" formControlName="timeMinutes" min="1" placeholder="e.g. 20" />
              <small class="err" *ngIf="fieldInvalid('timeMinutes')">Value must be ‚â• 1.</small>
            </label>

            <label class="field">
              <span>Servings</span>
              <input type="number" formControlName="servings" min="1" placeholder="e.g. 2" />
              <small class="err" *ngIf="fieldInvalid('servings')">Value must be ‚â• 1.</small>
            </label>

            <label class="field">
              <span>Difficulty</span>
              <select formControlName="difficulty">
                <option value="">‚Äî</option>
                <option value="Easy">Easy</option>
                <option value="Medium">Medium</option>
                <option value="Hard">Hard</option>
              </select>
            </label>
          </div>

          <label class="field">
            <span>Rating (0‚Äì5)</span>
            <input type="number" formControlName="rating" min="0" max="5" step="1" placeholder="e.g. 4" />
            <small class="err" *ngIf="fieldInvalid('rating')">Rating must be between 0 and 5.</small>
          </label>

          <div class="field">
            <span>Tags</span>
            <div class="chips">
              <input type="text" placeholder="Press Enter to add tag"
                     (keydown.enter)="$event.preventDefault(); addFromInput($event, 'tags')"
                     (blur)="addFromInput($event, 'tags')" />
              <div class="chip" *ngFor="let tag of tagsArr.controls; index as i">
                <span>#{{ tag.value }}</span>
                <button type="button" class="x" (click)="removeChip('tags', i)" aria-label="Remove">‚úï</button>
              </div>
            </div>
          </div>

          <div class="grid-2 compact">
            <label class="field">
              <span>Author name</span>
              <input type="text" formControlName="authorName" placeholder="e.g. Keti" />
            </label>
            <label class="field">
              <span>Author avatar URL</span>
              <input type="url" formControlName="authorAvatar" placeholder="https://..." />
            </label>
          </div>

          <label class="check">
            <input type="checkbox" formControlName="isFavorite" />
            <span>Mark as favorite</span>
          </label>
        </div>

        <!-- RIGHT (thumbnail) -->
        <div class="stack">
          <div class="field">
            <span>Thumbnail URL</span>
            <input type="url" formControlName="thumbnail" placeholder="https://..." (blur)="onThumbUrlBlur($event)" />
          </div>

          <div class="dropzone" (drop)="onDrop($event)" (dragover)="onDragOver($event)">
            <input type="file" accept="image/*" (change)="onFileSelected($event)" />
            <div class="dz-inner">
              <div class="emoji">üñºÔ∏è</div>
              <p>Drag & drop an image here or click to upload</p>
              <small>We‚Äôll store it as data URL for the demo</small>
            </div>
          </div>

          <div class="preview" *ngIf="thumbPreview || form.value.thumbnail">
            <img [src]="thumbPreview || form.value.thumbnail" alt="Preview" />
          </div>
        </div>
      </div>

      <div class="actions">
        <a routerLink="/" class="btn btn-ghost">Cancel</a>
        <button class="btn btn-primary shiny cta" type="submit" [disabled]="form.invalid">
          <span>Save Changes</span>
          <svg class="arrow" viewBox="0 0 24 24" width="18" height="18" aria-hidden="true">
            <path d="M5 12h12M13 6l6 6-6 6" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </button>
      </div>
    </form>
  </section>
</main>
